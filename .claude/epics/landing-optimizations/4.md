---
name: code-splitting-lazy-loading
title: Code Splitting & Lazy Loading
status: open
priority: medium
epic: landing-optimizations
dependencies: []
assignee: null
created: 2026-02-05T06:28:16Z
updated: 2026-02-05T06:40:35Z
---

# Code Splitting & Lazy Loading

## Objective
Implement intelligent code splitting and lazy loading to reduce initial bundle size and improve page load performance through dynamic imports.

## Description
Split the application code into optimal chunks, implement lazy loading for non-critical components, and optimize the bundle structure for business-type variants to minimize initial JavaScript payload.

## Acceptance Criteria

### Dynamic Imports for Heavy Components
- [ ] Lazy load testimonial carousel component
- [ ] Dynamic import for contact form modal
- [ ] Split business-type specific components
- [ ] Lazy load FAQ accordion sections
- [ ] Dynamic import for analytics/tracking scripts

### Code Splitting for Business Variants
- [ ] Split salon-specific components and styles
- [ ] Separate restaurant showcase components
- [ ] Isolate clinic/healthcare specific features
- [ ] Create shared component chunks
- [ ] Implement route-based splitting if needed

### Bundle Size Optimization
- [ ] Analyze current bundle with webpack-bundle-analyzer
- [ ] Identify and eliminate dead code
- [ ] Tree-shake unused library imports
- [ ] Split vendor libraries into separate chunks
- [ ] Optimize third-party script loading

### Critical CSS Extraction
- [ ] Extract above-the-fold CSS inline
- [ ] Defer non-critical CSS loading
- [ ] Implement critical CSS per business type
- [ ] Remove unused CSS rules
- [ ] Optimize CSS delivery pipeline

## Technical Implementation

### Dynamic Import Strategy
```javascript
// Lazy loading heavy components
const TestimonialCarousel = dynamic(() => import('../components/TestimonialCarousel'), {
  loading: () => <div className="animate-pulse h-64 bg-gray-200" />,
  ssr: false
})

// Business type specific imports
const SalonFeatures = dynamic(() => import('../components/business/SalonFeatures'))
const RestaurantFeatures = dynamic(() => import('../components/business/RestaurantFeatures'))
```

### Bundle Analysis Configuration
```javascript
// next.config.js
module.exports = {
  webpack: (config, { isServer }) => {
    if (!isServer) {
      config.optimization.splitChunks.chunks = 'all'
      config.optimization.splitChunks.cacheGroups = {
        vendor: {
          test: /[\\/]node_modules[\\/]/,
          chunks: 'all',
          name: 'vendor'
        },
        business: {
          test: /[\\/]components[\\/]business[\\/]/,
          chunks: 'all',
          name: 'business-components'
        }
      }
    }
    return config
  }
}
```

### Critical CSS Implementation
- Use `critical` package for above-fold CSS extraction
- Implement per-page critical CSS generation
- Configure build pipeline for CSS optimization
- Set up CSS preload hints

## Performance Targets

### Bundle Size Reduction
- Main bundle: < 150KB gzipped (currently ~300KB)
- Vendor chunks: < 200KB combined
- Business-specific chunks: < 50KB each
- Total JavaScript for initial load: < 250KB

### Loading Performance
- First Contentful Paint improvement: 0.5-1s
- JavaScript parse/compile time: < 200ms
- Time to Interactive improvement: 1-2s
- Reduce main thread blocking time by 40%

## Code Splitting Strategy

### High Priority for Lazy Loading
1. Testimonial carousel (heavy animations)
2. Contact form modal (only loaded on interaction)
3. FAQ accordions (below fold content)
4. Business-type specific showcases

### Keep in Main Bundle
1. Hero section components
2. Primary navigation
3. CTA buttons and forms
4. Critical utility functions

### Vendor Library Optimization
- Split React/Next.js into separate chunk
- Isolate animation libraries (Framer Motion)
- Separate form libraries (React Hook Form)
- Split styling libraries (Tailwind utilities)

## Definition of Done
- [ ] Dynamic imports implemented for heavy components
- [ ] Business-type code splitting active
- [ ] Bundle size targets achieved
- [ ] Critical CSS extraction working
- [ ] Loading performance improved
- [ ] Bundle analysis documented

## Dependencies
None - can run in parallel with other optimizations

## Estimated Effort
**6-8 hours**

## Notes
- Monitor impact on user experience during lazy loading
- Ensure proper loading states for dynamic components
- Test code splitting across all business type variants
- Document bundle optimization decisions for team
- Consider using next/dynamic with custom loading components
